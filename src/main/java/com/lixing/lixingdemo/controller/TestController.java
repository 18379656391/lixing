package com.lixing.lixingdemo.controller;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.lixing.lixingdemo.construct.Exception.BusinessException;
import com.lixing.lixingdemo.construct.HttpMessageConverter.MyEntity;
import com.lixing.lixingdemo.construct.basic.ResponseResult;
import com.lixing.lixingdemo.construct.basic.ResultCode;
import com.lixing.lixingdemo.controller.dto.TestDTO;
import com.lixing.lixingdemo.controller.dto.TestFormatDTO;
import com.lixing.lixingdemo.controller.dto.ValueExportFileDTO;
import com.lixing.lixingdemo.controller.dto.ValueExportRuleDTO;
import lombok.SneakyThrows;
import lombok.extern.slf4j.Slf4j;
import org.hibernate.validator.constraints.NotBlank;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

import javax.validation.Valid;
import java.lang.reflect.Field;
import java.util.*;
import java.util.function.Function;
import java.util.regex.Pattern;
import java.util.stream.Collectors;

/**
 * @author lixing41189
 * @version 1.0
 * @date 2023/12/24
 */
@RestController
@Slf4j
public class TestController {

    @PostMapping(value = "/test")
    ResponseResult testMethod() {
        System.out.println("执行controller业务方法----");
        return ResponseResult.success("success");
    }

    @RequestMapping(method = RequestMethod.POST, value = "/convert", produces = "application/lixing")
    public @ResponseBody MyEntity convert(@RequestBody MyEntity entity) {
        return entity;
    }

    /**
     * 只适用于表单提交数据或者url传参,不适用于json提交数据
     * @param testDTO
     * @return
     */
    @RequestMapping(method = RequestMethod.POST, value = "/testFormat")
    @SneakyThrows
    public ResponseResult<TestFormatDTO> testFormat(TestFormatDTO testDTO) {
        System.out.println("str size:" + testDTO.getStr().size());
        System.out.println("str1 size:" + testDTO.getStr1().size());
        System.out.println(testDTO);
        return ResponseResult.success(testDTO);
    }

    @RequestMapping(method = RequestMethod.POST, value = "/testRequest")
    @SneakyThrows
    public ResponseResult<TestDTO> testRequest(@RequestBody TestDTO testDTO) {
        Field date = testDTO.getClass().getDeclaredField("date");
        date.setAccessible(true);
        System.out.println(date.getType());
        System.out.println(testDTO.getJsonStr1().get(0));
        System.out.println(testDTO);
        if (testDTO.getDate().before(new Date())) {
            throw new BusinessException(ResultCode.DATE_EXPIRED);
        }
        return ResponseResult.success(testDTO);
    }

    @PostMapping(value = "/exportValuationByRule")
    ResponseEntity<byte[]> exportValuationByRule(@Valid @RequestBody ValueExportFileDTO requestDTO) {
        String fundCode = requestDTO.getFundCode();
        String businessDate = requestDTO.getBusinessDate();
        String subjectLevel = requestDTO.getSubjectLevel();
        String subjectCode = null;
        // 校验产品权限
        // checkUserFundAuth(fundCode,operatorCode,systemFlag);
        // todo 校验规则代码和设置级别
        List<ValueExportRuleDTO> ruleList = requestDTO.getRuleList();
        // 调用估值存过获取估值科目信息
        log.info("调用估值存过入参fundCode:{},businessDate:{},subjectLevel:{},subjectCode:{}", fundCode, businessDate, subjectLevel, subjectCode);
        //ResponseData valuationDetailTg = wbfaApiService.getValuationDetailWb(fundCode, businessDate, subjectLevel, subjectCode);
        //log.info("total data:{}", JSON.toJSONString(valuationDetailTg.getData()));

        // JSONArray totalArray = JSONArray.parseArray(JSON.toJSONString(valuationDetailTg.getData()));
        JSONArray totalArray = JSONArray.parseArray("[{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1038808.33,\"costValue\":0.1555,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1038808.33,\"subjectCode\":\"1002\",\"percentMarket\":0.1555,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"银行存款\",\"setCode\":1004,\"foreignCurrencyValue\":1038808.33,\"foreignCurrencyCost\":1038808.33,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100001,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1038808.33,\"costValue\":0.1555,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1038808.33,\"subjectCode\":\"100201\",\"percentMarket\":0.1555,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"活期存款\",\"setCode\":1004,\"foreignCurrencyValue\":1038808.33,\"foreignCurrencyCost\":1038808.33,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100002,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1038808.33,\"costValue\":0.1555,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1038808.33,\"subjectCode\":\"10020101\",\"percentMarket\":0.1555,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"活期存款\",\"setCode\":1004,\"foreignCurrencyValue\":1038808.33,\"foreignCurrencyCost\":1038808.33,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100003,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":62461555.68,\"costValue\":9.3508,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":62461555.68,\"subjectCode\":\"1021\",\"percentMarket\":9.3508,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"清算备付金\",\"setCode\":1004,\"foreignCurrencyValue\":62461555.68,\"foreignCurrencyCost\":62461555.68,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100005,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":61788104.7,\"costValue\":9.25,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":61788104.7,\"subjectCode\":\"102113\",\"percentMarket\":9.25,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"期货清算备付金\",\"setCode\":1004,\"foreignCurrencyValue\":61788104.7,\"foreignCurrencyCost\":61788104.7,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100006,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":999.81,\"costValue\":0.0001,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":999.81,\"subjectCode\":\"10211303\",\"percentMarket\":0.0001,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"广发期货\",\"setCode\":1004,\"foreignCurrencyValue\":999.81,\"foreignCurrencyCost\":999.81,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100007,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":61786941.47,\"costValue\":9.2498,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":61786941.47,\"subjectCode\":\"10211315\",\"percentMarket\":9.2498,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"永安期货\",\"setCode\":1004,\"foreignCurrencyValue\":61786941.47,\"foreignCurrencyCost\":61786941.47,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100008,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":163.42,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":163.42,\"subjectCode\":\"102113C0\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"东海期货\",\"setCode\":1004,\"foreignCurrencyValue\":163.42,\"foreignCurrencyCost\":163.42,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100009,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":673450.98,\"costValue\":0.1008,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":673450.98,\"subjectCode\":\"102181\",\"percentMarket\":0.1008,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"场外个股期权预付金\",\"setCode\":1004,\"foreignCurrencyValue\":673450.98,\"foreignCurrencyCost\":673450.98,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100010,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":4891793.57,\"costValue\":0.7323,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":4891793.57,\"subjectCode\":\"1031\",\"percentMarket\":0.7323,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"存出保证金\",\"setCode\":1004,\"foreignCurrencyValue\":4891793.57,\"foreignCurrencyCost\":4891793.57,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100011,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":4891793.57,\"costValue\":0.7323,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":4891793.57,\"subjectCode\":\"103108\",\"percentMarket\":0.7323,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"券商保证金账户\",\"setCode\":1004,\"foreignCurrencyValue\":4891793.57,\"foreignCurrencyCost\":4891793.57,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100012,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":384226.73,\"costValue\":0.0575,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":384226.73,\"subjectCode\":\"10310801\",\"percentMarket\":0.0575,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"广发证券\",\"setCode\":1004,\"foreignCurrencyValue\":384226.73,\"foreignCurrencyCost\":384226.73,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100013,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":4507566.84,\"costValue\":0.6748,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":4507566.84,\"subjectCode\":\"10310809\",\"percentMarket\":0.6748,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中信证券\",\"setCode\":1004,\"foreignCurrencyValue\":4507566.84,\"foreignCurrencyCost\":4507566.84,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100014,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":19283795.1,\"marketValue\":528998006.43,\"costValue\":76.307,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":509714211.33,\"subjectCode\":\"1102\",\"percentMarket\":79.1939,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"股票投资\",\"setCode\":1004,\"foreignCurrencyValue\":528998006.43,\"foreignCurrencyCost\":509714211.33,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100016,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":16756605.83,\"marketValue\":282181772.27,\"costValue\":39.7356,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":265425166.44,\"subjectCode\":\"110201\",\"percentMarket\":42.2442,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所A股\",\"setCode\":1004,\"foreignCurrencyValue\":282181772.27,\"foreignCurrencyCost\":265425166.44,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100017,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":16756605.83,\"marketValue\":282181772.27,\"costValue\":39.7356,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":265425166.44,\"subjectCode\":\"11020101\",\"percentMarket\":42.2442,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所A股成本\",\"setCode\":1004,\"foreignCurrencyValue\":282181772.27,\"foreignCurrencyCost\":265425166.44,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100018,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-1076529.03,\"marketValue\":5538038.04,\"costValue\":0.9902,\"managerCode\":\"007\",\"secuInterCode\":15634,\"quotationValue\":7.16,\"cost\":6614567.07,\"subjectCode\":\"11020101600019\",\"percentMarket\":0.8291,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":7.16,\"marketCode\":\"600019\",\"subjectDirection\":1,\"quantity\":773469,\"billingCurrency\":\"CNY\",\"unitCost\":8.55,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"宝钢股份\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":5538038.04,\"foreignCurrencyCost\":6614567.07,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100019,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":16756605.83,\"costValue\":2.5086,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":16756605.83,\"subjectCode\":\"11020199\",\"percentMarket\":2.5086,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所A股估值增值\",\"setCode\":1004,\"foreignCurrencyValue\":16756605.83,\"foreignCurrencyCost\":16756605.83,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100053,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-1076529.03,\"costValue\":-0.1612,\"managerCode\":\"007\",\"secuInterCode\":15634,\"quotationValue\":0,\"cost\":-1076529.03,\"subjectCode\":\"11020199600019\",\"percentMarket\":-0.1612,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"600019\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"宝钢股份\",\"setCode\":1004,\"foreignCurrencyValue\":-1076529.03,\"foreignCurrencyCost\":-1076529.03,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100054,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":680347.26,\"costValue\":0.1019,\"managerCode\":\"007\",\"secuInterCode\":15806,\"quotationValue\":0,\"cost\":680347.26,\"subjectCode\":\"11020199600038\",\"percentMarket\":0.1019,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"600038\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中直股份\",\"setCode\":1004,\"foreignCurrencyValue\":680347.26,\"foreignCurrencyCost\":680347.26,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100055,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":675413.4,\"costValue\":0.1011,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":675413.4,\"subjectCode\":\"110203\",\"percentMarket\":0.1011,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所新股\",\"setCode\":1004,\"foreignCurrencyValue\":675413.4,\"foreignCurrencyCost\":675413.4,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100091,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":675413.4,\"costValue\":0.1011,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":675413.4,\"subjectCode\":\"11020301\",\"percentMarket\":0.1011,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所新股成本\",\"setCode\":1004,\"foreignCurrencyValue\":675413.4,\"foreignCurrencyCost\":675413.4,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100092,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":675413.4,\"costValue\":0.1011,\"managerCode\":\"007\",\"secuInterCode\":797170,\"quotationValue\":57.58,\"cost\":675413.4,\"subjectCode\":\"11020301600941\",\"percentMarket\":0.1011,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":57.58,\"marketCode\":\"600941\",\"subjectDirection\":1,\"quantity\":11730,\"billingCurrency\":\"CNY\",\"unitCost\":57.58,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国移动\",\"setCode\":1004,\"suspensionNote\":\"【无行情】\",\"foreignCurrencyValue\":675413.4,\"foreignCurrencyCost\":675413.4,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100093,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":-1086610.21,\"marketValue\":22209338.04,\"costValue\":3.4875,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":23295948.25,\"subjectCode\":\"110208\",\"percentMarket\":3.3249,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"沪港通\",\"setCode\":1004,\"foreignCurrencyValue\":22209338.04,\"foreignCurrencyCost\":23295948.25,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100104,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":-1086610.21,\"marketValue\":22209338.04,\"costValue\":3.4875,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":23295948.25,\"subjectCode\":\"11020801\",\"percentMarket\":3.3249,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"股票成本_沪港通\",\"setCode\":1004,\"foreignCurrencyValue\":22209338.04,\"foreignCurrencyCost\":23295948.25,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100105,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-466138.99,\"marketValue\":1988007.84,\"costValue\":0.3674,\"managerCode\":\"007\",\"secuInterCode\":337199,\"quotationValue\":2.12,\"cost\":2454146.83,\"subjectCode\":\"11020801H00728\",\"percentMarket\":0.2976,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":2.12,\"marketCode\":\"00728\",\"subjectDirection\":1,\"quantity\":936000,\"billingCurrency\":\"CNY\",\"unitCost\":2.62,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国电信\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":1988007.84,\"foreignCurrencyCost\":2454146.83,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100106,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-400203.67,\"marketValue\":6613949.16,\"costValue\":1.0501,\"managerCode\":\"007\",\"secuInterCode\":336467,\"quotationValue\":38.23,\"cost\":7014152.83,\"subjectCode\":\"11020801H00941\",\"percentMarket\":0.9901,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":38.23,\"marketCode\":\"00941\",\"subjectDirection\":1,\"quantity\":173000,\"billingCurrency\":\"CNY\",\"unitCost\":40.54,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国移动\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":6613949.16,\"foreignCurrencyCost\":7014152.83,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100107,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-60007.14,\"marketValue\":266636.16,\"costValue\":0.0489,\"managerCode\":\"007\",\"secuInterCode\":337200,\"quotationValue\":4.17,\"cost\":326643.3,\"subjectCode\":\"11020801H01186\",\"percentMarket\":0.0399,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":4.17,\"marketCode\":\"01186\",\"subjectDirection\":1,\"quantity\":64000,\"billingCurrency\":\"CNY\",\"unitCost\":5.1,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国铁建\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":266636.16,\"foreignCurrencyCost\":326643.3,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100108,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":32493.75,\"marketValue\":2057264.62,\"costValue\":0.3031,\"managerCode\":\"007\",\"secuInterCode\":337215,\"quotationValue\":6.72,\"cost\":2024770.87,\"subjectCode\":\"11020801H01378\",\"percentMarket\":0.308,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":6.72,\"marketCode\":\"01378\",\"subjectDirection\":1,\"quantity\":306000,\"billingCurrency\":\"CNY\",\"unitCost\":6.62,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国宏桥\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":2057264.62,\"foreignCurrencyCost\":2024770.87,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100109,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-270519.27,\"marketValue\":10986716.83,\"costValue\":1.6853,\"managerCode\":\"007\",\"secuInterCode\":337222,\"quotationValue\":3.46,\"cost\":11257236.1,\"subjectCode\":\"11020801H01800\",\"percentMarket\":1.6448,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":3.46,\"marketCode\":\"01800\",\"subjectDirection\":1,\"quantity\":3172000,\"billingCurrency\":\"CNY\",\"unitCost\":3.55,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国交通建设\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":10986716.83,\"foreignCurrencyCost\":11257236.1,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100110,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":77765.11,\"marketValue\":296763.43,\"costValue\":0.0328,\"managerCode\":\"007\",\"secuInterCode\":337211,\"quotationValue\":7.81,\"cost\":218998.32,\"subjectCode\":\"11020801H03323\",\"percentMarket\":0.0444,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":7.81,\"marketCode\":\"03323\",\"subjectDirection\":1,\"quantity\":38000,\"billingCurrency\":\"CNY\",\"unitCost\":5.76,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国建材\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":296763.43,\"foreignCurrencyCost\":218998.32,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100111,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-1086610.21,\"costValue\":-0.1627,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":-1086610.21,\"subjectCode\":\"11020899\",\"percentMarket\":-0.1627,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"估值增值_沪港通\",\"setCode\":1004,\"foreignCurrencyValue\":-1086610.21,\"foreignCurrencyCost\":-1086610.21,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100112,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-466138.99,\"costValue\":-0.0698,\"managerCode\":\"007\",\"secuInterCode\":337199,\"quotationValue\":0,\"cost\":-466138.99,\"subjectCode\":\"11020899H00728\",\"percentMarket\":-0.0698,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"00728\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国电信\",\"setCode\":1004,\"foreignCurrencyValue\":-466138.99,\"foreignCurrencyCost\":-466138.99,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100113,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-400203.67,\"costValue\":-0.0599,\"managerCode\":\"007\",\"secuInterCode\":336467,\"quotationValue\":0,\"cost\":-400203.67,\"subjectCode\":\"11020899H00941\",\"percentMarket\":-0.0599,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"00941\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国移动\",\"setCode\":1004,\"foreignCurrencyValue\":-400203.67,\"foreignCurrencyCost\":-400203.67,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100114,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-60007.14,\"costValue\":-0.009,\"managerCode\":\"007\",\"secuInterCode\":337200,\"quotationValue\":0,\"cost\":-60007.14,\"subjectCode\":\"11020899H01186\",\"percentMarket\":-0.009,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"01186\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国铁建\",\"setCode\":1004,\"foreignCurrencyValue\":-60007.14,\"foreignCurrencyCost\":-60007.14,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100115,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":32493.75,\"costValue\":0.0049,\"managerCode\":\"007\",\"secuInterCode\":337215,\"quotationValue\":0,\"cost\":32493.75,\"subjectCode\":\"11020899H01378\",\"percentMarket\":0.0049,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"01378\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国宏桥\",\"setCode\":1004,\"foreignCurrencyValue\":32493.75,\"foreignCurrencyCost\":32493.75,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100116,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-270519.27,\"costValue\":-0.0405,\"managerCode\":\"007\",\"secuInterCode\":337222,\"quotationValue\":0,\"cost\":-270519.27,\"subjectCode\":\"11020899H01800\",\"percentMarket\":-0.0405,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"01800\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国交通建设\",\"setCode\":1004,\"foreignCurrencyValue\":-270519.27,\"foreignCurrencyCost\":-270519.27,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100117,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":77765.11,\"costValue\":0.0116,\"managerCode\":\"007\",\"secuInterCode\":337211,\"quotationValue\":0,\"cost\":77765.11,\"subjectCode\":\"11020899H03323\",\"percentMarket\":0.0116,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"03323\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国建材\",\"setCode\":1004,\"foreignCurrencyValue\":77765.11,\"foreignCurrencyCost\":77765.11,\"tradeMarket\":44,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100118,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":6620571.11,\"marketValue\":173319381.28,\"costValue\":24.9557,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":166698810.17,\"subjectCode\":\"110231\",\"percentMarket\":25.9469,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深交所A股\",\"setCode\":1004,\"foreignCurrencyValue\":173319381.28,\"foreignCurrencyCost\":166698810.17,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100134,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":6620571.11,\"marketValue\":173319381.28,\"costValue\":24.9557,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":166698810.17,\"subjectCode\":\"11023101\",\"percentMarket\":25.9469,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深交所A股成本\",\"setCode\":1004,\"foreignCurrencyValue\":173319381.28,\"foreignCurrencyCost\":166698810.17,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100135,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":1351778.48,\"marketValue\":25368612,\"costValue\":3.5955,\"managerCode\":\"007\",\"secuInterCode\":18043,\"quotationValue\":33.5,\"cost\":24016833.52,\"subjectCode\":\"11023101000063\",\"percentMarket\":3.7978,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":33.5,\"marketCode\":\"000063\",\"subjectDirection\":1,\"quantity\":757272,\"billingCurrency\":\"CNY\",\"unitCost\":31.71,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中兴通讯\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":25368612,\"foreignCurrencyCost\":24016833.52,\"tradeMarket\":2,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100136,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-12895.68,\"marketValue\":6575806.9,\"costValue\":0.9864,\"managerCode\":\"007\",\"secuInterCode\":18096,\"quotationValue\":16.9,\"cost\":6588702.58,\"subjectCode\":\"11023101000503\",\"percentMarket\":0.9844,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":16.9,\"marketCode\":\"000503\",\"subjectDirection\":1,\"quantity\":389101,\"billingCurrency\":\"CNY\",\"unitCost\":16.93,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"海虹控股\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":6575806.9,\"foreignCurrencyCost\":6588702.58,\"tradeMarket\":2,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100137,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":1281137.76,\"marketValue\":31674474,\"costValue\":4.55,\"managerCode\":\"007\",\"secuInterCode\":18225,\"quotationValue\":20.07,\"cost\":30393336.24,\"subjectCode\":\"11023101000672\",\"percentMarket\":4.7418,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":20.07,\"marketCode\":\"000672\",\"subjectDirection\":1,\"quantity\":1578200,\"billingCurrency\":\"CNY\",\"unitCost\":19.26,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上峰水泥\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":31674474,\"foreignCurrencyCost\":30393336.24,\"tradeMarket\":2,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100138,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1487.7,\"costValue\":0.0002,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1487.7,\"subjectCode\":\"11023301\",\"percentMarket\":0.0002,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深交所新股成本\",\"setCode\":1004,\"foreignCurrencyValue\":1487.7,\"foreignCurrencyCost\":1487.7,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100174,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1487.7,\"costValue\":0.0002,\"managerCode\":\"007\",\"secuInterCode\":798115,\"quotationValue\":16.53,\"cost\":1487.7,\"subjectCode\":\"11023301001234\",\"percentMarket\":0.0002,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":16.53,\"marketCode\":\"001234\",\"subjectDirection\":1,\"quantity\":90,\"billingCurrency\":\"CNY\",\"unitCost\":16.53,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"泰慕士\",\"setCode\":1004,\"suspensionNote\":\"【无行情】\",\"foreignCurrencyValue\":1487.7,\"foreignCurrencyCost\":1487.7,\"tradeMarket\":2,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100175,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":91868.22,\"marketValue\":2562318.93,\"costValue\":0.3698,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":2470450.71,\"subjectCode\":\"110241\",\"percentMarket\":0.3836,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深交所A股_创业板\",\"setCode\":1004,\"foreignCurrencyValue\":2562318.93,\"foreignCurrencyCost\":2470450.71,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100189,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":91868.22,\"marketValue\":2562318.93,\"costValue\":0.3698,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":2470450.71,\"subjectCode\":\"11024101\",\"percentMarket\":0.3836,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深交所A股成本_创业板\",\"setCode\":1004,\"foreignCurrencyValue\":2562318.93,\"foreignCurrencyCost\":2470450.71,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100190,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-56267,\"marketValue\":2266260,\"costValue\":0.3477,\"managerCode\":\"007\",\"secuInterCode\":533748,\"quotationValue\":64.2,\"cost\":2322527,\"subjectCode\":\"11024101300745\",\"percentMarket\":0.3393,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":64.2,\"marketCode\":\"300745\",\"subjectDirection\":1,\"quantity\":35300,\"billingCurrency\":\"CNY\",\"unitCost\":65.79,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"欣锐科技\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":2266260,\"foreignCurrencyCost\":2322527,\"tradeMarket\":2,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100191,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":-3375437.86,\"marketValue\":41645582.43,\"costValue\":6.7399,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":45021020.29,\"subjectCode\":\"110283\",\"percentMarket\":6.2346,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深港通股票\",\"setCode\":1004,\"foreignCurrencyValue\":41645582.43,\"foreignCurrencyCost\":45021020.29,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100301,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":-3375437.86,\"marketValue\":41645582.43,\"costValue\":6.7399,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":45021020.29,\"subjectCode\":\"11028301\",\"percentMarket\":6.2346,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"深港通股票成本\",\"setCode\":1004,\"foreignCurrencyValue\":41645582.43,\"foreignCurrencyCost\":45021020.29,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100302,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":-137973.94,\"marketValue\":1741630.8,\"costValue\":0.2814,\"managerCode\":\"007\",\"secuInterCode\":444881,\"quotationValue\":2.12,\"cost\":1879604.74,\"subjectCode\":\"11028301H00728\",\"percentMarket\":0.2607,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":2.12,\"marketCode\":\"00728\",\"subjectDirection\":1,\"quantity\":820000,\"billingCurrency\":\"CNY\",\"unitCost\":2.29,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中国电信　　　　\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":1741630.8,\"foreignCurrencyCost\":1879604.74,\"tradeMarket\":30,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100303,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":276798.01,\"marketValue\":6402712.38,\"costValue\":0.9171,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":6125914.37,\"subjectCode\":\"1102C1\",\"percentMarket\":0.9585,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所_科创板\",\"setCode\":1004,\"foreignCurrencyValue\":6402712.38,\"foreignCurrencyCost\":6125914.37,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100371,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":276798.01,\"marketValue\":6402712.38,\"costValue\":0.9171,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":6125914.37,\"subjectCode\":\"1102C101\",\"percentMarket\":0.9585,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"股票成本_上交所_科创板\",\"setCode\":1004,\"foreignCurrencyValue\":6402712.38,\"foreignCurrencyCost\":6125914.37,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100372,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":165574.16,\"marketValue\":1390216.54,\"costValue\":0.1833,\"managerCode\":\"007\",\"secuInterCode\":584729,\"quotationValue\":96.94,\"cost\":1224642.38,\"subjectCode\":\"1102C101688122\",\"percentMarket\":0.2081,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":96.94,\"marketCode\":\"688122\",\"subjectDirection\":1,\"quantity\":14341,\"billingCurrency\":\"CNY\",\"unitCost\":85.39,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"N超导\",\"setCode\":1004,\"suspensionNote\":\"【正常交易】\",\"foreignCurrencyValue\":1390216.54,\"foreignCurrencyCost\":1224642.38,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100373,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":631000,\"costValue\":0.0945,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":631000,\"subjectCode\":\"1103\",\"percentMarket\":0.0945,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"债券投资\",\"setCode\":1004,\"foreignCurrencyValue\":631000,\"foreignCurrencyCost\":631000,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100454,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":631000,\"costValue\":0.0945,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":631000,\"subjectCode\":\"110372\",\"percentMarket\":0.0945,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"未上市可转债\",\"setCode\":1004,\"foreignCurrencyValue\":631000,\"foreignCurrencyCost\":631000,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100522,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":631000,\"costValue\":0.0945,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":631000,\"subjectCode\":\"11037201\",\"percentMarket\":0.0945,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"未上市可转债成本\",\"setCode\":1004,\"foreignCurrencyValue\":631000,\"foreignCurrencyCost\":631000,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100523,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":631000,\"costValue\":0.0945,\"managerCode\":\"007\",\"secuInterCode\":797475,\"quotationValue\":100,\"cost\":631000,\"subjectCode\":\"11037201113052\",\"percentMarket\":0.0945,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":100,\"marketCode\":\"113052\",\"subjectDirection\":1,\"quantity\":6310,\"billingCurrency\":\"CNY\",\"unitCost\":100,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"兴业转债\",\"setCode\":1004,\"suspensionNote\":\"【无行情】\",\"foreignCurrencyValue\":631000,\"foreignCurrencyCost\":631000,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100524,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":72400724,\"costValue\":10.8388,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":72400724,\"subjectCode\":\"1202\",\"percentMarket\":10.8388,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"买入返售金融资产\",\"setCode\":1004,\"foreignCurrencyValue\":72400724,\"foreignCurrencyCost\":72400724,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100681,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":72400724,\"costValue\":10.8388,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":72400724,\"subjectCode\":\"120201\",\"percentMarket\":10.8388,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所买入回购\",\"setCode\":1004,\"foreignCurrencyValue\":72400724,\"foreignCurrencyCost\":72400724,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100682,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":72400724,\"costValue\":10.8388,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":72400724,\"subjectCode\":\"12020101\",\"percentMarket\":10.8388,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"上交所质押式回购\",\"setCode\":1004,\"foreignCurrencyValue\":72400724,\"foreignCurrencyCost\":72400724,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100683,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":72400724,\"costValue\":10.8388,\"managerCode\":\"007\",\"secuInterCode\":17984,\"quotationValue\":0,\"cost\":72400724,\"subjectCode\":\"12020101204001\",\"percentMarket\":10.8388,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"204001\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"GC001\",\"setCode\":1004,\"foreignCurrencyValue\":72400724,\"foreignCurrencyCost\":72400724,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100684,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-36690.67,\"costValue\":-0.0055,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":-36690.67,\"subjectCode\":\"1204\",\"percentMarket\":-0.0055,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收利息\",\"setCode\":1004,\"foreignCurrencyValue\":-36690.67,\"foreignCurrencyCost\":-36690.67,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100733,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":86.41,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":86.41,\"subjectCode\":\"120401\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收银行存款利息\",\"setCode\":1004,\"foreignCurrencyValue\":86.41,\"foreignCurrencyCost\":86.41,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100734,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":86.41,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":86.41,\"subjectCode\":\"12040101\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收活期银行存款利息\",\"setCode\":1004,\"foreignCurrencyValue\":86.41,\"foreignCurrencyCost\":86.41,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100735,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":86.41,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":86.41,\"subjectCode\":\"12040101000001\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收活期存款利息\",\"setCode\":1004,\"foreignCurrencyValue\":86.41,\"foreignCurrencyCost\":86.41,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100736,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":426.81,\"costValue\":0.0001,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":426.81,\"subjectCode\":\"120406\",\"percentMarket\":0.0001,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收结算保证金利息\",\"setCode\":1004,\"foreignCurrencyValue\":426.81,\"foreignCurrencyCost\":426.81,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100740,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":426.81,\"costValue\":0.0001,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":426.81,\"subjectCode\":\"12040606\",\"percentMarket\":0.0001,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收利息_券商保证金\",\"setCode\":1004,\"foreignCurrencyValue\":426.81,\"foreignCurrencyCost\":426.81,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100741,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":400.29,\"costValue\":0.0001,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":400.29,\"subjectCode\":\"12040606000009\",\"percentMarket\":0.0001,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"中信证券\",\"setCode\":1004,\"foreignCurrencyValue\":400.29,\"foreignCurrencyCost\":400.29,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100742,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":26.52,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":26.52,\"subjectCode\":\"1204060601\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"广发证券\",\"setCode\":1004,\"foreignCurrencyValue\":26.52,\"foreignCurrencyCost\":26.52,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100743,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":13.83,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":13.83,\"subjectCode\":\"120410\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收债券利息\",\"setCode\":1004,\"foreignCurrencyValue\":13.83,\"foreignCurrencyCost\":13.83,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100744,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":13.83,\"costValue\":0,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":13.83,\"subjectCode\":\"12041012\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收上交所可转债利息\",\"setCode\":1004,\"foreignCurrencyValue\":13.83,\"foreignCurrencyCost\":13.83,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100746,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":4,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":13.83,\"costValue\":0,\"managerCode\":\"007\",\"secuInterCode\":797475,\"quotationValue\":0,\"cost\":13.83,\"subjectCode\":\"12041012113052\",\"percentMarket\":0,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"113052\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"兴业转债\",\"setCode\":1004,\"foreignCurrencyValue\":13.83,\"foreignCurrencyCost\":13.83,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100747,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-37217.72,\"costValue\":-0.0056,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":-37217.72,\"subjectCode\":\"120491\",\"percentMarket\":-0.0056,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收回购计息\",\"setCode\":1004,\"foreignCurrencyValue\":-37217.72,\"foreignCurrencyCost\":-37217.72,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100805,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":3,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":-37217.72,\"costValue\":-0.0056,\"managerCode\":\"007\",\"secuInterCode\":17980,\"quotationValue\":0,\"cost\":-37217.72,\"subjectCode\":\"12049111\",\"percentMarket\":-0.0056,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"marketCode\":\"204014\",\"subjectDirection\":1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应收上交所质押式回购计息\",\"setCode\":1004,\"foreignCurrencyValue\":-37217.72,\"foreignCurrencyCost\":-37217.72,\"tradeMarket\":1,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100806,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1637929.9,\"costValue\":0.2452,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1637929.9,\"subjectCode\":\"2206\",\"percentMarket\":0.2452,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付管理人报酬\",\"setCode\":1004,\"foreignCurrencyValue\":1637929.9,\"foreignCurrencyCost\":1637929.9,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100916,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":1637929.9,\"costValue\":0.2452,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":1637929.9,\"subjectCode\":\"220601\",\"percentMarket\":0.2452,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付管理费\",\"setCode\":1004,\"foreignCurrencyValue\":1637929.9,\"foreignCurrencyCost\":1637929.9,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100917,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":98275.75,\"costValue\":0.0147,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":98275.75,\"subjectCode\":\"2207\",\"percentMarket\":0.0147,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付托管费\",\"setCode\":1004,\"foreignCurrencyValue\":98275.75,\"foreignCurrencyCost\":98275.75,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100918,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":98275.75,\"costValue\":0.0147,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":98275.75,\"subjectCode\":\"220701\",\"percentMarket\":0.0147,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付托管费\",\"setCode\":1004,\"foreignCurrencyValue\":98275.75,\"foreignCurrencyCost\":98275.75,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100919,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":1,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":32758.59,\"costValue\":0.0049,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":32758.59,\"subjectCode\":\"2211\",\"percentMarket\":0.0049,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付外包服务费\",\"setCode\":1004,\"foreignCurrencyValue\":32758.59,\"foreignCurrencyCost\":32758.59,\"exchangeRate\":0,\"fundCode\":\"SM0005\",\"numberNo\":100940,\"createTime\":\"2022-01-02 10:26:35\"},{\"subjectLevel\":2,\"isConfirm\":1,\"valueIncrease\":0,\"marketValue\":32758.59,\"costValue\":0.0049,\"managerCode\":\"007\",\"quotationValue\":0,\"cost\":32758.59,\"subjectCode\":\"221101\",\"percentMarket\":0.0049,\"fundName\":\"红筹1号证券投资基金\",\"managerName\":\"深圳市红筹投资有限公司\",\"workDate\":\"2021-12-31 00:00:00\",\"foreignCurrencyMarket\":0,\"subjectDirection\":-1,\"quantity\":0,\"billingCurrency\":\"CNY\",\"unitCost\":0,\"custodian\":\"广发证券股份有限公司\",\"subjectName\":\"应付外包服务费\",\"setCode\":1004,\"foreignCurrencyValue\":32758.59,\"foreignCurrencyCost\":32758.59,\"exchangeRate\":1,\"fundCode\":\"SM0005\",\"numberNo\":100941,\"createTime\":\"2022-01-02 10:26:35\"}]");
        List<JSONObject> totalList = JSONObject.parseArray(JSON.toJSONString(totalArray), JSONObject.class);
        // 四位数字开头的科目，过滤非底级统计科目
        String regex = "^\\d{4}\\S*$";
        Pattern compile = Pattern.compile(regex);

        // 过滤底级统计科目,将科目数据按照1，2，3，4科目分组
        Map<String, List<JSONObject>> levelGroupData = totalList.stream().filter(o -> compile.matcher(o.getString("subjectCode")).matches())
                .collect(Collectors.groupingBy(o -> o.getString("subjectLevel")));
        log.info("levelGroupData:{}", JSON.toJSONString(levelGroupData));

        Map<String, JSONObject> getDataMap = totalList.stream().collect(Collectors.toMap(o -> o.getString("subjectCode"), Function.identity(), (t1, t2) -> t1));


        // todo delete
        List<String> tempViewList = totalArray.stream().map(o -> ((JSONObject)o).getString("subjectCode")).collect(Collectors.toList());
        log.info("tempViewList:{}", JSON.toJSONString(tempViewList));

        List<String> ruleCodeList = ruleList.stream().map(ValueExportRuleDTO::getSubjectNo).collect(Collectors.toList());
        log.info("ruleCodeList:{}", JSON.toJSONString(ruleCodeList));
        // 先去重,同样的科目设置代码，取科目展示层级大的
        List<ValueExportRuleDTO> distinctRuleList = new ArrayList<>(ruleList.stream().collect(Collectors.groupingBy(ValueExportRuleDTO::getSubjectNo,
                Collectors.collectingAndThen(Collectors.reducing((a, b) ->
                        Integer.parseInt(a.getDisplayLevel()) > Integer.parseInt(b.getDisplayLevel()) ? a : b
                ), Optional::get))).values());
        // 科目设置计算
        // 不分组
        // 排序
        List<ValueExportRuleDTO> ruleSortedList = sorted(distinctRuleList);
        // 家庭集合
        List<Set<ValueExportRuleDTO>> familyGroup = new ArrayList<>();
        Set<ValueExportRuleDTO> allFamilySet = new HashSet<>();
        // 计算子孙关系
        for (int i = 0; i < ruleSortedList.size(); i++) {
            Set<ValueExportRuleDTO> familySet = null;
            for (int j = i + 1; j < ruleSortedList.size(); j++) {
                if (ruleSortedList.get(j).getSubjectNo().startsWith(ruleSortedList.get(i).getSubjectNo())) {
                    // 子孙关系成立
                    if (null == familySet) {
                        familySet = new LinkedHashSet<>();
                    }
                    // 加入自己
                    familySet.add(ruleSortedList.get(i));
                    familySet.add(ruleSortedList.get(j));
                }
            }
            if (null != familySet) {
                allFamilySet.addAll(familySet);
                familyGroup.add(familySet);
            }
        }
        // 求差集得到非父子集合的设置
        ruleSortedList.removeAll(allFamilySet);
        log.info("singleList:{}", JSON.toJSONString(ruleSortedList));
        log.info("familyGroup:{}", JSON.toJSONString(familyGroup));
        // 结果集取并集
        Set<JSONObject> singleResult = calculateData(getDataMap, levelGroupData, ruleSortedList, Boolean.FALSE);
        Set<JSONObject> familyResult = new HashSet<>();
        familyGroup.forEach(item -> {
            familyResult.addAll(calculateData(getDataMap, levelGroupData, new ArrayList<>(item), Boolean.TRUE));
        });
        log.info("singleResult:{}", JSON.toJSONString(singleResult));
        log.info("familyResult:{}", JSON.toJSONString(familyResult));
        // 所有设置规则算出的汇总数据
        singleResult.addAll(familyResult);
        // 汇总数据拼接计算结果数据，先删除设置的规则数据，在拼接计算记过
        Set<JSONObject> finalSet = intersectCollection(totalList, ruleCodeList, singleResult);
        // 最后按照numberNo升序排序
        // todo 先临时换成String delete
        List<String> finalList = finalSet.stream().sorted(new Comparator<JSONObject>() {
            @Override
            public int compare(JSONObject o1, JSONObject o2) {
                return o1.getIntValue("numberNo") - o2.getIntValue("numberNo");
            }
        }).map(o -> o.getString("subjectCode")).collect(Collectors.toList());
        log.info("finalList:{}", JSON.toJSONString(finalList));
        return null;
    }

    private String groupMethod(ValueExportRuleDTO dto) {
        return dto.getSubjectNo().substring(0, 4);
    }

    private List<ValueExportRuleDTO> sorted(List<ValueExportRuleDTO> list) {
        return list.stream().sorted(new Comparator<ValueExportRuleDTO>() {
            @Override
            public int compare(ValueExportRuleDTO o1, ValueExportRuleDTO o2) {
                return o1.getSubjectNo().length() - o2.getSubjectNo().length();
            }
        }).collect(Collectors.toList());
    }

    /**
     *
     * @param levelGroupData 汇总分组数据
     * @param ruleList       规则列表（必须按照科目等级从小到大排序）
     * @param mixed          是否求交集 true:求交集 false:求并集
     * @return
     */
    private Set<JSONObject> calculateData(Map<String, JSONObject> getDataMap, Map<String, List<JSONObject>> levelGroupData, List<ValueExportRuleDTO> ruleList, Boolean mixed) {
        Set<JSONObject> totalSet = new HashSet<>();

        Set<JSONObject> childSet = new HashSet<>();
        List<JSONObject> mainList = new ArrayList<>();
        List<String> setList = new ArrayList<>();
        for (int i = 0; i < ruleList.size(); i++) {
            ValueExportRuleDTO rule = ruleList.get(i);
            List<JSONObject> list = new ArrayList<>();
            for (int j = 0; j < Integer.parseInt(judgeCurrentLevel(rule.getSubjectNo())) -1; j++) {
                // 4 + (2*j)
                int endIndex = 4 + (2 * j);
                list.add(getDataMap.get(rule.getSubjectNo().substring(0, endIndex)));
            }
            // 拿规则进行结果集计算
            cal(levelGroupData, getDataMap.get(rule.getSubjectNo()), rule.getDisplayLevel(), list);
            log.info("rule:{},----calculate data:{}", JSON.toJSONString(rule), JSON.toJSONString(list));
            if (!mixed || ruleList.size() == 1) {
                totalSet.addAll(list);
            } else {
                // 求交集(删除交集部分，再合并)
                // 存在子规则
                if (i == 0) {
                    mainList = list;
                } else {
                    childSet.addAll(list);
                    setList.add(rule.getSubjectNo());
                }
            }
        }
        if (childSet.size() > 0) {
            // 交集返回
            return intersectCollection(mainList, setList, childSet);
        } else {
            // 并集返回
            return totalSet;
        }
    }

    /**
     *
     * @param mainList 主集合
     * @param setList  设置的科目集合
     * @param childSet 设置的科目算出的结果
     * @return
     */
    private Set<JSONObject> intersectCollection(List<JSONObject> mainList, List<String> setList, Set<JSONObject> childSet) {
        // 循环主集合，删除以设置科目代码开头的数据，然后拼接科目代码计算得到的数据
        for (String s : setList) {
            mainList.removeIf(item -> item.getString("subjectCode").startsWith(s));
        }
        mainList.addAll(childSet);
        return new HashSet<>(mainList);
    }


    private void cal(Map<String, List<JSONObject>> levelGroupData, JSONObject subjectNoObject, String displayLevel, List<JSONObject> allData) {
        allData.add(subjectNoObject);
        String subjectNo = subjectNoObject.getString("subjectCode");
        String currentLevel = String.valueOf(Integer.parseInt(judgeCurrentLevel(subjectNo)) + 1);
        if (Integer.parseInt(currentLevel) > Integer.parseInt(displayLevel)) {
            return;
        }
        // 递归调用
        levelGroupData.get(currentLevel).stream()
                .filter(item -> item.getString("subjectCode").startsWith(subjectNo))
                .peek(m -> cal(levelGroupData, m, displayLevel, allData))
                .collect(Collectors.toList());
    }

    private String judgeCurrentLevel(@NotBlank String subjectNo) {
        switch (subjectNo.length()) {
            case 4:
                return "1";
            case 6:
                return "2";
            case 8:
                return "3";
            default:
                return "4";
        }
    }


}
